PORT=8000

# ============================================
# CONFIGURACIÓN BASE DE DATOS (REQUERIDO)
# ============================================
# El sistema intenta conexión en este orden:
# 1. deno-postgres (biblioteca nativa Deno) - RECOMENDADO
# 2. supabase-js (cliente oficial Supabase) - FALLBACK

# ============================================
# OPCIÓN 1: PostgreSQL Directo (deno-postgres)
# ============================================
# URL de conexión PostgreSQL con SSL requerido para Supabase
# Formato: postgresql://user:password@host:port/database?sslmode=require
POSTGRES_URL=postgresql://postgres:password@db.your-project.supabase.co:5432/postgres?sslmode=require

# ============================================
# OPCIÓN 2: Supabase (fallback)
# ============================================
# Si deno-postgres falla, se usa supabase-js automáticamente
# Configurar estas variables como respaldo:

# URL del proyecto Supabase
# Obtener de: https://supabase.com/dashboard → Project Settings → API → URL
SUPABASE_URL=https://your-project-ref.supabase.co

# Service Role Key (NO usar Anon Key)
# Obtener de: https://supabase.com/dashboard → Project Settings → API → service_role key
# ⚠️ NUNCA exponer esta key en el frontend - es solo para backend
SUPABASE_SERVICE_ROLE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

# ============================================
# SEGURIDAD Y AUTENTICACIÓN (REQUERIDO)
# ============================================

# Modo de operación: development | production
MODO=development

# Orígenes permitidos para CORS (separados por coma)
# En desarrollo: http://localhost:5173 (Vite default)
# En producción: https://tu-dominio.com,https://www.tu-dominio.com
ALLOWED_ORIGINS=http://localhost:5173

# Clave secreta para firmar tokens JWT (¡GENERAR CLAVE FUERTE EN PRODUCCIÓN!)
# Mínimo 32 caracteres aleatorios
# Generar con: openssl rand -base64 32
JWT_SECRET=tu_clave_secreta_muy_segura_minimo_32_caracteres

# Algoritmo de firma JWT
# Opciones: HS256 (recomendado), HS384, HS512
JWT_ALGORITHM=HS256

# ============================================
# INSTRUCCIONES DE CONFIGURACIÓN
# ============================================

# 1. Copiar este archivo: cp .env.example .env
# 2. Configurar POSTGRES_URL con tus credenciales de Supabase (recomendado)
# 3. Configurar SUPABASE_URL y SUPABASE_SERVICE_ROLE_KEY (fallback obligatorio)
# 4. Generar JWT_SECRET seguro para producción
# 5. Ajustar ALLOWED_ORIGINS según tu dominio frontend
# 6. NUNCA subir .env a git (ya está en .gitignore)

# ============================================
# NOTAS IMPORTANTES
# ============================================

# Sistema de conexión dual:
# - Primero intenta con deno-postgres (más rápido y completo)
# - Si falla, automáticamente usa supabase-js después de 2 segundos
# - Logs detallados indican cuál driver se conectó exitosamente

# Requisitos mínimos:
# - POSTGRES_URL (para conexión nativa recomendada)
# - SUPABASE_URL + SUPABASE_SERVICE_ROLE_KEY (para fallback)

# Las cookies httpOnly se manejan automáticamente para autenticación
# El token JWT se renueva automáticamente mediante endpoint /usuario/refresh
# En Deno Deploy, configurar todas las variables en el dashboard del proyecto
